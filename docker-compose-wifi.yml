---
# This compose file is used for wifi-connected setups
# It is meant to be used in tandem with the Base Compose template
version: "3.3"
services:
  MQTT-Server:
    container_name: mqtt_broker
    hostname: mosquitto
    image: eclipse-mosquitto@sha256:3fe51e69feba9c20a2d16414052ad5639baa2afcfb33f4a955c6fd33e0903eb5
    ports:
      - "1883:1883"
    volumes:
      - ./mosquitto.conf:/mosquitto/config/mosquitto.conf
  wifiwriter:
    depends_on:
      - "MQTT-Server"
      - "mariadb"
    image: dms-lite-wifiwriter:${DMSLITEVERSION}
    build:
      dockerfile: Dockerfile
      context: ./Wifi-sql-writer
    links:
      - mariadb
    environment:
      MYSQL_DATABASE: "${MYSQL_DATABASE}"
      MYSQL_USER: "${MYSQL_USER}"
      MYSQL_PASSWORD: "${MYSQL_PASSWORD}"
